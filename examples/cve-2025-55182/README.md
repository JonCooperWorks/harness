# CVE-2025-55182 Exploit Plugin

A harness plugin that exploits CVE-2025-55182, a Next.js and React.js vulnerability involving prototype pollution and command injection.

## Building

```bash
cargo build --target wasm32-wasip1 --release
```

The compiled WASM will be at: `target/wasm32-wasip1/release/cve_2025_55182_plugin.wasm`

## Encrypting, Signing, and Running

```bash
# First, encrypt the plugin (Exploit Owner)
./bin/encrypt \
  -plugin examples/cve-2025-55182/target/wasm32-wasip1/release/cve_2025_55182_plugin.wasm \
  -type wasm \
  -harness-key harness_public.pem \
  -target-key target_public.pem \
  -exploit-keystore-key "exploit-key" \
  -output cve-2025-55182.encrypted

# Then, sign with execution arguments (Target)
./bin/sign \
  -file cve-2025-55182.encrypted \
  -target-keystore-key "target-key" \
  -exploit-key exploit_public.pem \
  -harness-key harness_public.pem \
  -args '{"base_urls":["http://localhost:3000"],"executable":"id"}' \
  -output cve-2025-55182.approved

# Finally, execute the plugin (Harness)
./bin/harness \
  -file cve-2025-55182.approved \
  -harness-keystore-key "harness-key" \
  -target-key target_public.pem \
  -exploit-key exploit_public.pem
```

## Arguments

- `base_urls` (required, array): Array of base URLs of target Next.js or React.js applications to scan. Supports network scanning by testing multiple URLs in a single execution.
- `executable` (optional): The command to execute on the target system (defaults to `echo HARNESS_<random_number>` for vulnerability testing)

### Example: Network Scan

To scan multiple URLs, provide an array of base URLs:

```bash
-args '{"base_urls":["http://example.com:3000","http://example.com:3001","http://test.example.com"],"executable":"id"}' \
```

## How It Works

This plugin exploits a prototype pollution vulnerability in Next.js and React.js by:

1. Iterating through each provided base URL
2. Crafting a malicious chunk that pollutes the prototype chain
3. Sending a POST request with multipart form data containing the crafted payload to each URL
4. The payload triggers command execution through Next.js's internal handling of form data
5. Returns results for each URL including HTTP status code, response body, and vulnerability status

The plugin supports network scanning by testing multiple URLs in a single execution. Results are returned as an array with individual results for each URL, including a summary with the total number of URLs tested and the count of vulnerable endpoints.

## Security Note

This plugin is for authorized security testing only. Use only on systems you own or have explicit permission to test.
